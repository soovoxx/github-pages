---
title: "모놀리식 레포의 문제점을 개선하기 위한 MSA"
slug: "mono-repository-3"
pubDate: "2025-11-11 22:50:30"
summary: "모놀리식 레포의 문제점 보완"
category: "msa"
series: "Microservice Architecture"
tags: ["msa"]
---

# 장점

## 1. ALL or Nothing 배포, 전체 롤백 문제

- 모놀리식

  - 기능 하나 고쳐도 전체 `jar` / `war` 배포
  - 문제가 생겼을때 전체롤백(프로그램 수정을 보수적으로 할 수 밖에 없음)

- MSA
  - 서비스 단위로 배포 / 롤백 가능
  - 학생정보 시스템 배포 , 같은시각 수강관리 시스템 유지

> 이것은 **MSA가 꽤 깔끔하게 개선**해주는 영역이 맞음

## 2. 장애 범위가 크다는것

- 모놀리식

  - 수강신청에서 `Out Of Memory` 발생시
  - 같은 JVM에서 동작중인 로그인 / 성적조회 / 교수화면 학사관련된 시스템 **All Stop**

- MSA
  - 수강신청에서 문제가 발생해도 타 시스템에는 영향을 미치지 않음
  - 빠른대처가 가능 (모놀리식이었으면, 전교생에게 문자 공지후 긴급배포 진행했을듯)

> **장애 격리(Isolation)** 은 매우 유리해짐

## 3. 스케일링 단위가 크다는것

- 모놀리식

  - 수강신청 트래픽만 폭증해도, 앱 전체(수강신청, 로그인, 성적조회, 인사관리 ...) 인스턴스를 늘려야함

- MSA
  - 수강신청 트래픽 초과시 수강신청 관련한 인스턴스만 늘릴 수 있음

> 기능들이 잘게 쪼개져 있다보니, 스케일링 효율이나 비용측면은 확실히 강점이긴 함

## 4. 빌드/테스트/배포 시간이 너무 긴 문제

- 모놀리식

  - ex. DB컬럼이 누락되어서 값이 나오지 않는 문제 있어, 컬럼추가만 했는데도 앱 전체서비스를 빌드하고 배포해야함

- 폴리레포 + MSA
  - 서비스마다, 레포지토리가 분리되어있음
  - 각각 빌드, 테스트, 배포 파이프라인 분리가 가능

> CI를 잘짜면, 변경된 서비스만 빌드 + 테스트가 가능하다고 하는데, 저렇게 운영되고 있는 프로젝트에선 그런거 못봤음 아직..

## 5. 공통 모듈 변경 = 전체 리스크 문제

이건 MSA를 쓰나 모놀리식이나 똑같은 문제긴 한데, MSA일때는 공통 모듈관련한 부분은 둘다 똑같다고 생각함

수정자를 한명만 수정하게끔, 프로젝트내에서 규율같은걸 지킨다거나 **(모놀리식인 경우)**,

submodule(.gitsubmodule) 업데이트가 진행되었을때, 프로젝트 공지로 submodule 업데이트 권장한다거나 **(MSA)**

## 6. 조직/프로세스 문제

- 모놀리식

  - 팀 간 독립성이 낮고, 배포일정을 전사적으로 맞춰야함 (예를들면 정기배포는 매주 수요일 저녁입니다 ...)

- MSA
  - 서비스 단위로 "우리 팀이 우리 서비스" 철저하게 가져갈 수 있음
  - 빠른 배포 / 실험 가능

> 근데 MSA로 바꿔도 **"어~ 배포일정은 매주 수요일 저녁에 해~😊"** 이러면 뭐 모놀리식이나 MSA나 다를게 없음

---

# 단점

## 1. 네트워크/통신 복잡성

- 모놀리식에서는 메소드 호출 여러번해서 한번 요청하면 끝나던걸 여러서비스를 호출하면서 데이터 인증을 해야함

> enrollment-service → student-service → auth-service 체인 호출

- 여기사이에 student-service가 과부하가 있다면, 다른서비스에게도 영향을 줄 수 있음

## 2. 분산 트랜잭션, 데이터 일관성 부족

- 한 메소드안에서 여러테이블을 업데이트를 진행해야 한다고 한다면 모놀리식은 함수위에(자바기준) `@Transactional` 어노테이션만 붙이면 끝남

- But, MSA에서는 서비스가 흩어져있으니, 중간에 문제가 발생하면 롤백이 되지 않음

> 그래서 오류가 발생한 시점으로부터 `없던것 처럼` 하기위한 보상트랜잭션(Saga 패턴)을 진행함 (`aka. 수기로 하는 롤백`)

- 항상 즉시 일관된 데이터는 포기하고
- 잠시동안은 데이터가 일관되지 않을 수 있음을 감안하고 봐야한다는것
- "나는 수강신청 성공했는데 왜 시간표에 안뜨지 ???" -> 실제 작업중인것

## 3. 모니터링, 로그파악 난이도가 너무 높다

- 모놀리식은 로그가 한서버, 한 어플리케이션, 하나의 폴더에 모여있음
- MSA는 서비스별로 로그가 다르니 그 서비스에 인스턴스가 10-20개씩 올라가있다고 가정하면 그 오류 찾으려고 10-20개 파일을 뒤적여야 한다는것(~.. 쿠버네티스만 있으면~)

## 4. 테스트 난이도 증가

- 단위테스트는 서비스별로 잘게 쪼개놔서 간단할 수 있지만,
- 정말어려운건 E2E(end to end) 테스트

## 5. 인프라, 운영 부담 증가

- MSA를 제대로 굴리려면 아래의 시스템들을 구축해야함
  1. 컨테이너(Docker)
  2. 오케스트레이션(쿠버네티스)
  3. 서비스 디스커버리
  4. Config 관리
  5. API Gateway

### 장점

- 자동 스케일링, 롤링 업데이트, Self-healing

### 단점

- 세팅, 운영 난이도가 있음
- 데브옵스 지식 없으면 불가능

## 6. 소규모 프로젝트에는 맞지않음

- 서비스가 10개일때, repository 10개+, CI/CD 10개+, 모니터링 10개+, 여기에 dev/stg/prod 로 나눈다 하면, 그만큼 복잡해짐

> 소규모 팀이나, 소규모 프로젝트를 하는데는 **too much** 느낌

---

# 결론

### 1. MSA를 도입했을경우 장점

> 장애범위 / 배포범위 / 스케일링 문제 해소가능

### 2. MSA를 도입했을경우 단점

> 분산시스템의 복잡도와, 보상트랜잭션 고려문제 이슈가 있음

### 3. 개인적인 생각

> 기술적으로 해결할 수도 있는 부분이지만, 당연하다고 생각되었던 부분에서 새로운 문제가 초래되고 있다는걸 느낌 <br/>
> 서비스를 나눴을때 팀마다 배포전략이라던지, 공통소스 전략등을
